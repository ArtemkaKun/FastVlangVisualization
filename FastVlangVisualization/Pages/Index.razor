@page "/"
@using FastVlangVisualization.DataGrabSystem
@using FastVlangVisualization.DataGrabSystem.PerformanceTestDataSystem

<PageTitle>Index</PageTitle>

@if (PerformanceData == null || PerformanceData.Count == 0)
{
    <p>
        <em>Loading...</em>
    </p>
}
else
{
    <div class="container">
        <div class="row">
            <div class="col-sm-12 my-5">
                <RadzenChart>
                    <RadzenLineSeries Smooth="@staff" Data="@TestData" CategoryProperty="Timestamp" Title="Name" ValueProperty="PerformanceResultNumericValue">
                        <RadzenMarkers MarkerType="MarkerType.None"/>
                    </RadzenLineSeries>
                </RadzenChart>
                <RadzenCategoryAxis Padding="20" FormatString="{0:MMM}" />
            </div>
        </div>
    </div>
}

@code {
    bool staff = false;
    private IDataGrabber DataGrabber { get; } = new FastVlangWebPageDataGrabber("https://fast.vlang.io/");
    private List<IVlangPerformanceTestData> PerformanceData { get; set; }
    List<IVlangPerformanceTestData> TestData => GetVToCCompileTime();

    protected override async Task OnInitializedAsync ()
    {
        PerformanceData = await DataGrabber.GetVlangSpeedDataAsync();
    }

    protected List<IVlangPerformanceTestData> GetVToCCompileTime ()
    {
        return PerformanceData.Where(test => test.Name == "v -o v.c").ToList();
    }
}